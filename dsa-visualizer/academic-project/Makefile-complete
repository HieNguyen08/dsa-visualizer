# Makefile for DSA Visualizer Academic Report

# Variables
MAIN_FILE = academic_report_complete
TEX_FILES = $(MAIN_FILE).tex chapters/*.tex
BIB_FILE = refs.bib
OUTPUT_DIR = output
PDF_OUTPUT = $(OUTPUT_DIR)/$(MAIN_FILE).pdf

# Default target
all: $(PDF_OUTPUT)

# Create output directory
$(OUTPUT_DIR):
	mkdir -p $(OUTPUT_DIR)

# Build PDF with bibliography
$(PDF_OUTPUT): $(TEX_FILES) $(BIB_FILE) | $(OUTPUT_DIR)
	@echo "Building PDF..."
	pdflatex -output-directory=$(OUTPUT_DIR) $(MAIN_FILE).tex
	biber $(OUTPUT_DIR)/$(MAIN_FILE)
	pdflatex -output-directory=$(OUTPUT_DIR) $(MAIN_FILE).tex
	pdflatex -output-directory=$(OUTPUT_DIR) $(MAIN_FILE).tex
	@echo "PDF built successfully: $(PDF_OUTPUT)"

# Quick build without bibliography
quick: $(TEX_FILES) | $(OUTPUT_DIR)
	@echo "Quick building PDF..."
	pdflatex -output-directory=$(OUTPUT_DIR) $(MAIN_FILE).tex
	@echo "Quick PDF built: $(PDF_OUTPUT)"

# Clean build files
clean:
	@echo "Cleaning build files..."
	rm -rf $(OUTPUT_DIR)/*
	@echo "Clean completed"

# Clean and rebuild
rebuild: clean all

# View PDF (requires PDF viewer)
view: $(PDF_OUTPUT)
	@echo "Opening PDF..."
	start $(PDF_OUTPUT)  # Windows
	# open $(PDF_OUTPUT)    # macOS
	# xdg-open $(PDF_OUTPUT)  # Linux

# Help
help:
	@echo "Available targets:"
	@echo "  all      - Build complete PDF with bibliography"
	@echo "  quick    - Quick build without bibliography"
	@echo "  clean    - Remove all build files"
	@echo "  rebuild  - Clean and rebuild"
	@echo "  view     - Open PDF after building"
	@echo "  help     - Show this help"

# Force rebuild targets
.PHONY: all quick clean rebuild view help
