\documentclass[tikz,border=10pt]{standalone}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[vietnamese]{babel}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows, positioning, shapes.multipart, fit, calc}

\tikzset{
    layer/.style={
        draw,
        rectangle,
        minimum width=10cm,
        minimum height=2cm,
        text centered,
        font=\small,
        fill=blue!10
    },
    component/.style={
        draw,
        rectangle,
        minimum width=2.5cm,
        minimum height=1cm,
        text centered,
        font=\scriptsize,
        fill=white
    },
    database/.style={
        draw,
        cylinder,
        shape border rotate=90,
        minimum width=2cm,
        minimum height=1.5cm,
        text centered,
        font=\scriptsize,
        fill=yellow!20
    },
    service/.style={
        draw,
        rectangle,
        rounded corners,
        minimum width=2cm,
        minimum height=1cm,
        text centered,
        font=\scriptsize,
        fill=green!20
    },
    external/.style={
        draw,
        rectangle,
        dashed,
        minimum width=2cm,
        minimum height=1cm,
        text centered,
        font=\scriptsize,
        fill=orange!20
    }
}

\begin{document}
\begin{tikzpicture}[node distance=2.5cm]

% Title
\node[above] at (0,15) {\Large \textbf{System Architecture - DSA Visualizer Platform}};

% ===== PRESENTATION LAYER =====
\node[layer] (presentation) at (0,13) {\textbf{Frontend Layer (Next.js 15 + React 19)}};

% Frontend components with better spacing
\node[component] (main_ui) at (-5,13) {Main UI\\React Components};
\node[component] (visualizers) at (-1.5,13) {Algorithm\\Visualizers};
\node[component] (admin_ui) at (2,13) {Admin\\Dashboard};
\node[component] (ai_chat) at (5.5,13) {AI Assistant\\Interface};

% ===== API LAYER =====
\node[layer] (api_layer) at (0,10.5) {\textbf{API Layer (Next.js API Routes)}};

% API endpoints with proper spacing
\node[component] (auth_api) at (-5,10.5) {Auth API\\NextAuth.js};
\node[component] (algorithm_api) at (-2,10.5) {Algorithm\\API};
\node[component] (ai_api) at (1,10.5) {AI Assistant\\API};
\node[component] (progress_api) at (4,10.5) {Progress\\API};

% ===== SERVICE LAYER =====
\node[layer] (service) at (0,8) {\textbf{Service Layer}};

% Services with better positioning
\node[service] (visualizer_service) at (-5,8) {Visualization\\Engine};
\node[service] (algorithm_service) at (-2,8) {Algorithm\\Execution};
\node[service] (ai_service) at (1,8) {AI Processing\\Service};
\node[service] (notification_service) at (4,8) {Notification\\Service};

% ===== DATA LAYER =====
\node[layer] (data_layer) at (0,5.5) {\textbf{Data Layer}};

% Databases with proper spacing
\node[database] (user_db) at (-4.5,5.5) {User\\Database\\(MongoDB)};
\node[database] (session_db) at (-1.5,5.5) {Session\\Store\\(Redis)};
\node[database] (progress_db) at (1.5,5.5) {Progress\\Database};
\node[database] (analytics_db) at (4.5,5.5) {Analytics\\Database};

% ===== EXTERNAL SERVICES =====
\node[layer] (external_layer) at (0,3) {\textbf{External Services}};

% External services properly spaced
\node[external] (openai) at (-4,3) {OpenAI\\GPT API};
\node[external] (github) at (-1,3) {GitHub\\Authentication};
\node[external] (google) at (2,3) {Google\\Analytics};
\node[external] (vercel) at (5,3) {Vercel\\Deployment};

% ===== INFRASTRUCTURE =====
\node[layer] (infrastructure) at (0,0.5) {\textbf{Infrastructure \& DevOps}};

% Infrastructure components
\node[component] (monitoring) at (-3,0.5) {Monitoring\\Logs};
\node[component] (security) at (0,0.5) {Security\\Layer};
\node[component] (cdn) at (3,0.5) {CDN\\Assets};

% ===== CONNECTIONS =====
% Frontend to API
\draw[->] (main_ui) -- (auth_api);
\draw[->] (visualizers) -- (algorithm_api);
\draw[->] (admin_ui) -- (progress_api);
\draw[->] (ai_chat) -- (ai_api);

% API to Services
\draw[->] (auth_api) -- (visualizer_service);
\draw[->] (algorithm_api) -- (algorithm_service);
\draw[->] (ai_api) -- (ai_service);
\draw[->] (progress_api) -- (notification_service);

% Services to Data
\draw[->] (visualizer_service) -- (user_db);
\draw[->] (algorithm_service) -- (session_db);
\draw[->] (ai_service) -- (progress_db);
\draw[->] (notification_service) -- (analytics_db);

% External connections
\draw[->] (ai_service) -- (openai);
\draw[->] (auth_api) -- (github);
\draw[->] (analytics_db) -- (google);

% Infrastructure connections
\draw[->] (service) -- (monitoring);
\draw[->] (api_layer) -- (security);
\draw[->] (presentation) -- (cdn);

\end{tikzpicture}
\end{document}
